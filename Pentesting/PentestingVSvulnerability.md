

### Vulnerability Assessment:
1- examination of infromation system security, incuding system connected to the internet, applications, and online network equipmen components via vulnerability scanners.
2- a systematic review of security waekness i  a  information system.

TYES of VA
1- Host Assessment
2- Network and wirless Asessment
3- Database assessment
4- Application Assessment

Penetration tests classification:
* Black box tests:tester completly ignorant of the system, and obtained information DNS, WEb, email, and internet service from server that are exposed publically by comapny
* white box test:  oppostite of black box test, tester communicate with non-IT staff face to face to collect information, network topoly, employ information
* Covert test: test the ability of the inspection unit monitor, respond to, and recover information security event



####  VA Steps
1- Reconnaissance
2- scanning
3- Gaining Access
4- Maintaing Access
5- Clearning Tracks 


#### ------------- LABS on Ghanima -----------------
#### 1-MAP the network
Network Mappper (NMAP): It is a network maping tool. port scanner. commonly used for security audits
provides, port taple, re erse DNS names, OS, device types and MAC addresses

-A: perform an aggressve scan
-sP: perm only ping scan
-sS: TCP SYN scan
-sT: TCP connect scan
-sU: UDP scan 
-sO: IP prorocol scan
-F ; Fast scan
-p: scan specofc port
-O: Operating Systsen detaction (O is capital)
-sV: Service version detection 
-open : only display open ports
-packet-trace: trace packets
-Pn: port scan only no host doscovery, treat all host as online -- skip host discovery 
-oN: output in a file
-T<time>: defin etime to send packets; T4 for per request
  
lab on Ghanima: sudo nmap -sS -A -p 9000 -T4 -O -Pn -oN nmap_practice corruptpolitico.com

#### 2-Hunting down the user profile
  TOOL Name: Sherlock, it is a web scrapper.
  
go to [sherlock](https://github.com/sherlock-project/sherlock) colne the repo into the system, go into sherlock dir 
run requirments file follwing command
 
``` 
# install the requirements
$ python3 -m pip install -r requirements.txt
```
how to run
  *  python3 sherlock <profileer name>
  *  python3 sherlock eric
  
This search the usr name in  the list of the website in sites.md
  
##### 3- VA using ZAP
Tool Name: [ZAP](https://www.zaproxy.org/). It is from OWASP. Zed Attack Proxy (ZAP)
  It is ulternatice of Burp Suit
  
  
##### 4- Burp Suit Installation
  community version free.
  Target ---> Issue defination: This have list of all VA that can be detected. IN scope we can  addd specific webste as target
  Intruder: it set the payload based on given word list.
  Extender: Bapp store: GIve us external extentions.
  
  ###### Integrate External Browser with Burp Suit
  Steps 
  1- Instal foxyProxy extention in browser
   after instaltion Clik on options, add name, HTTP (requast), IP: local host 127.0.0.1, any port number lke 8085. Okay. It show new name in extention
  2- IT will not work with new set proxy. need Certificate. go http://burp/ down load certificate and add ingto browser setting
   setting --> certificate import certificate and add downloaded certificate.
  3- In proxy (Brup Suit click Intrutor on and then click forward). 
  then in prxy HTTP history check all histroy of the requst which goes through set proxy. 

 Personal NOTE: 
  1- Watch Playing arount with Burp Suit from VA lectures
  2- Watch Intruuction to Burp Suit from WSTG

  
  ##### 6- DNS Recon
  DNS: Domain Name server, IT mapp the name ti ip address. 
  A Address record (Ipv4)
  AAAA Address Record (IPv6)
  CNAME Canonical Name record : It is most important, If any webseerver redirect the site to other webserver using CNAME. This show the real IP of the webserver
  MX MAil Exchange record
  NS Nameserver record
  SOA start of Authority record
  SRV Service Location record
  TXT Text record
  TOOL: 
  ###### 1-Host
  host <target web  anme>
  host -t ns <site name> : ns is name server
  host -t mx <target site name> : mx is teh mail server
  
  
  ###### 2-nslookup
  nslookup <target site name>: deatils of site
  
  nslookup <hit enter>
  set type=ns
  site name
  
  ###### 3- dig
  dig -t ns icebreakerspro.com : Get dns infrmation
  dig -t AAAA icebreakerspro.com
  
  dig -t ns icebreakerspro.com +short : to get teh information in short
  ```
  for ip in `dig -t ns icebreakerspro.com +short`; do nmap -Pn $ip; done :
  ```
  here we used the nmap with dig to check the open ports.
  
  Visual Display: www.dnsdumster.com
  
  ######## 4 - Recon-ng
  clone the [Recon-ng](https://github.com/lanmaster53/recon-ng)
  go to the Recon-ng dir and install requirments
  pip install -r requrments.txt
  
  then
  
  ./recon-ng : this will open recon-ng display
  write helpL this will show all commands 
  marketplace search : This command shwo teh all avaiable modules in Recon-ng
  marketplace search <name of module> : this will search all related modules
  
  let supose we are working with wois module 
  marketplace search whois -- this will show all the modules with whos is we will use following module
  
  ###MOUDLUEs
  
  NAME: recon/domains-contacts/whois_pocs   
  marketplace install recon/domains-contacts/whois_pocs   : Install module
  modules load recon/domains-contacts/whois_pocs  : Move into module to use
  info: this command shwo teh all detail if te modules
  here we can set the SOURCE using following command
  
  options set SOURCE google.com : This cmd set the source to google.com
  
  run: this will run the module
  back: this will back up from this module.
  
  
  
  Harvests hosts 
  Harvests hosts from Google.com by using the 'site' search operator. Updates the 'hosts' table with
  the results.

  This module is collecting info using serach engins
  NAME: recon/domains-hosts/google_site_web  
   Do all the same process as we did in previous example
  
  MOdule to find subdomains:  
  info: Brute forces host names using DNS. Updates the 'hosts' table with the results.
  discover host name of the DNS. We can chnage teh worldlist as well. default it has wordlist.
  recon/domains-hosts/brute_hosts
  
  Ineresting files
  Checks hosts for interesting files in predictable locations.
  discovery/info_disclosure/interesting_files 
  
 
  NOTE: you can also make icone for recon-ng tool. follwoing are te seteps.
  
  
  
  ##### 5-Nmap Scrpting Engine (NSE)
  Tool: NMAP:
The NSE is the one of powerfull and flexible featurees. IT allow user users t write simple scripts to automate a wide varity of networking tasks. These scripts are writen in Lua programming language and in NAMP these scriptrs are stores in 
the follwing location 
``` 
  /usr/share/nmap/scripts/
  For Information: nmap.org/book/nse.html  
  
  These scriptes are categorized into diff. classes. The detail of the all scripts are at nmap.org/nsedoc/scripts/ 
``` 


  NOw lets some Scripts:
  
 1-http-headers: performs a HEAD request for the root folder ("/") of web server and displays the HTTP headers returned. 
  
  sudo nmap -sV --script http-headers.nse -p 80  <Targetwebsite>
  sudo nmap -sV --script http-headers.nse -p 80  -d <TargetWebsite>: -d here is used as debug to understant backend detail of the script
  
 2- dns-brute: Attemps to enmuerate DNS hostnames by brute force guessing of common subdomains. With the brute-brute.srv argument, dns-brute will als try to ensumerate common DNS SRV records 
  
  sudo nmap --script dns-brute --script-args dns-brute.threads=6,dns-brute.hostfile=/home/zubair/Desktop/hostfile.txt -sS apserv3.ghanimahlabs.com
  
3-traceroute-geolocationt: iost the geographic location of each hop in the a raceroute and optionally save the result to KML file, plottable on google earth and maps
  sudo nmap --traceroute --script traceroute-geolocation appserv3.ghanimahlabs.com

  
  
 4-whois-domain.nse: Attempsts to retrieve information about the domain name of the target.
  
  sudo nmap --script whois-domain.nse icebreakerspro.com
  
  ##### 6- Flan Scan
  tool: [Flan scan](https://github.com/cloudflare/flan): 
  Flan Scan is a lightweight network vulnerability scanner. With Flan Scan you can easily find open ports on your network, identify services and their       version, and get a list of relevant CVEs affecting your network. It is warpper over NAMP. 
  
  ```
  sudo nmap -sV -oX result -oN - -v1 $@ --script=vulners.nse -p 80 icebreakerspro.com 
  
  Note: If port is ffiltered mean blocked by Firewall then vulnerability results will not be shwon.
  ```
  ########### Certificate using Open SSL.
  tool: opensssl: This tool used to get detail of the ssl cert. organtizatio unit aname etc.
  
  ```
  openssl s_client -showcerts -servername microsoft.com -connect microsoft.com:443
  https: http + ssl = port number 443
  ```
  
  
  ###8 - Detecting Firewell
 Egeproping: Detect the port is open or not aslso check it is filtered or not by fireweall. This is used to detect that if we sent packet to check open port the sending packet is filtered by target Firewell or Not. This check the firewall.
  
  STEPS:
  1- check the target ip using dig or nslookup tool.
  2- use following command
  ```
  sudo nmap -sA 210.107.239.136 -p 21 --reason : this with show the result filtered or unfiltered
  filtered =  Block by firewall
  unfiltered = unblock by firewall
  port= 21 is FTP port
  --reason = used for detailed expolration
  ```
  We can check the in-depth detail from Network analyser ```WIRESHARK ``` when we run the above cmd and chcek the wireshark we can see the red color packets which show the RST: mean resent because unfiltered show resest reason
  
 ### How to prevent intruction detection systsem while scanning.
  Dqway: This behaves as scan done by dierent ips.
  ```
  sudo nmap -sS -p 21 -sV -D 120.9.0.0,104.26.9.186,172.67.75.234,104.26.8.186,ME  <Target site>
  -sS: TCP SYN scan. SYN mean stealth scan . It uses three ways handshak. IT detect the port contition open /close before third handshak. It is difficult to detect by intruction system 
  ```
  - Here -D mean we add some Ip address other then our own (Me), In this way namp send TCP packets withnthe mentioned IPs and become diff. for Intruction detection system (IDS) to detect attcker ip. 
  
  NOTE: Must used live ips with own ips. otherwise IDS can check the mentioned ip is live is up or down and can find you. 
  
  
  ##### 8- The mad cat aka Hash cat: 
  tool:hashcat: match the hashes of the password
  
  
  
  
  ##### TOOL to collaborate with Team
   [Dradis](https://dradisframework.com/pricing.html)
  This is used to mange Cybersecurity Project.
  
  
  
  
  
  
  
  
  
  
  
  

